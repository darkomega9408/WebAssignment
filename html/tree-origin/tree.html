<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tree</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../../js/jquery-2.2.1.min.js"></script>

    <link rel="stylesheet" href="../../css/tree.css"/>
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/member-card.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/membercard.js"></script>
    <!--<script src="../../js/tree.js"></script>-->
</head>
<body>
<!--
We will create a family tree using just CSS(3)
The markup will be simple nested lists
-->
<button id="btn">Click Me</button>

<div class="tree">

</div>
<!-- ~~ Tree  -->


<!-- Member-info-modal -->
<div id="modal-edit-user" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Someone's Information</h4>
            </div>
            <div class="modal-body">
                <div class="member-modal-avatar">
                    <img src="../../images/aboutus/Thai.jpg" class="img-circle img-responsive" alt="/*name*/">
                </div>

                <form role="form" class="form-horizontal">
                    <div class="form-group">
                        <label class="control-label col-sm-2">Name: </label>
                        <div class="col-sm-10"><input type="text" class="form-control" value="Nguyễn Xuân Thái"></div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-2">Gender: </label>
                        <div class="col-sm-10"><select class="form-control">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="undefined">Undefined</option>
                        </select></div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Date of birth: </label>
                        <div class="col-sm-10"><input type="date" class="form-control" value="October 29, 1994"></div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Address: </label>
                        <div class="col-sm-10"><input type="text" class="form-control" value="Too long, lazy to type"></div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Birthplace: </label>
                        <div class="col-sm-10"><input type="text" class="form-control" value="HCMC"></div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">Status: </label>
                        <span class="radio-inline"><input type="radio" name="radioStatus" checked>Alive</span>
                        <span class="radio-inline"><input type="radio" name="radioStatus">Dead</span>
                    </div>
                </form>
                <!--<table class="member-modal-info">
                    <tr>
                        <td>Name: </td>
                        <td><input type="text" class="form-control" value="Nguyễn Xuân Thái"></td>
                    </tr>
                    <tr>
                        <td>Gender: </td>
                        <td>
                            <select class="form-control">
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="undefined">Undefined</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>Date of birth: </td>
                        <td><input type="date" class="form-control" value="October 29, 1994"></td>
                    </tr>
                    <tr>
                        <td>Address: </td>
                        <td><input type="text" class="form-control" value="Too long, lazy to type"></td>
                    </tr>
                    <tr>
                        <td>Birthplace: </td>
                        <td><input type="text" class="form-control" value="HCMC"></td>
                    </tr>
                    <tr>
                        <td>Status: </td>
                        <td>
                            <span class="radio-inline"><input type="radio" name="optradio" checked>Alive</span>
                            <span class="radio-inline"><input type="radio" name="optradio">Dead</span>
                        </td>
                    </tr>
                    &lt;!&ndash;date of death&ndash;&gt;
                </table>-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-dismiss="modal">Update</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>
<!-- ~~ Member-info-modal -->

<!-- Modal Delete  -->
<div class="modal fade" id="modal-delete-user" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                <h4 class="modal-title custom_align Heading" >Delete this entry</h4>
            </div>
            <div class="modal-body">

                <div class="alert alert-danger"><span class="glyphicon glyphicon-warning-sign"></span> Are you sure you want to delete this member?</div>

            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-success"><span class="glyphicon glyphicon-ok-sign"></span> Yes</button>
                <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> No</button>
            </div>
        </div>
    </div>
</div>
<!-- ~~ Modal Delete -->

<script>
    $(document).ready(function () {

        // Click button trigger event
        $('#btn').click(function () {
            $.ajax({
                url: '../tree-demo/GetListMember.php',
                type: 'POST'
            }).done(function (data) {
                // show response
                data = JSON.parse(data);
                createTree(data);
            }).fail(function () {
                alert("Post failed");
            });
        });


        // Some variables
        var memberCardObj = "";
        var member = "mem";

        // Load member card from another file and assign to '@memberCardObj'
        $('.tree').load('../card-demo/membercard-demo.html .membercard', function () {
            memberCardObj = $(this).clone();
            $(this).html('');
        });
        // ~~

        // Set information for each member based on DB
        var setInfoMemberCard = function (data, memberCardObj) {
            $(memberCardObj).find('.membercard').attr('id', member + data.MemberID);
            $(memberCardObj).find('.memberName').html(data.Name);
            $(memberCardObj).find('.memberBirthDate').html(data.BirthDate);
            $(memberCardObj).find('.memberBirthPlace').html(data.BirthPlace);
            return $(memberCardObj).html();
        };
        // ~~

        // Use to create tree html
        // data: server 's response , get from DB
        var createTree = function (data) {
            var nbrNode = data.length;

            // Set width for tree
            $('.tree').css('width',nbrNode*300+'px');

            // Add Root node ( if any )
            if( nbrNode <= 0 ) return;
            else $('.tree').append("<ul><li>"+ setInfoMemberCard(data[0],memberCardObj) +"</li></ul>");

            // Add Child node
            for(i = 1 ; i< nbrNode ; ++i) {
                var content = "<li>" + setInfoMemberCard(data[i], memberCardObj) + "</li>";
                if( $('#' + member + data[i].Father + '+ul').length <= 0 )
                    $('#' + member + data[i].Father).after("<ul>" + content + "</ul>");
                else
                    $('#' + member + data[i].Father + '+ul').append(content);
            }
        }



    });
</script>
</body>
</html>